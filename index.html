<!DOCTYPE html>
<html lang="en" id="htmlRoot">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="pageTitle">üöó Algerian Car Import Calculator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        'alg-green': '#006233',
                        'alg-gold': '#D4AF37',
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');
        * { box-sizing: border-box; }
        body { font-family: 'Inter', sans-serif; }

        /* Mobile-first text sizing */
        @media (max-width: 640px) {
            body { font-size: 14px; }
            label { font-size: 0.875rem; }
        }

        /* Remove default number arrows */
        input[type=number]::-webkit-inner-spin-button,
        input[type=number]::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; }
        input[type=number] { -moz-appearance: textfield; }

        /* Custom stepper wrapper */
        .stepper-wrap { position: relative; display: flex; align-items: center; }
        .stepper-wrap input {
            width: 100%;
            padding: 0.5rem 2.6rem 0.5rem 0.85rem;
            background: #1e293b;
            border: 1px solid #334155;
            border-radius: 0.5rem;
            color: #fff;
            font-size: 0.95rem;
            transition: border-color 0.2s, box-shadow 0.2s;
        }
        .stepper-wrap input:focus {
            outline: none;
            border-color: #006233;
            box-shadow: 0 0 0 3px rgba(0,98,51,0.15);
        }
        .stepper-btns {
            position: absolute;
            right: 4px;
            display: flex;
            flex-direction: column;
            gap: 1px;
        }
        .stepper-btns button {
            width: 22px; height: 16px;
            background: #334155;
            border: none;
            border-radius: 3px;
            color: #94a3b8;
            cursor: pointer;
            font-size: 9px;
            line-height: 1;
            display: flex; align-items: center; justify-content: center;
            transition: background 0.15s, color 0.15s;
        }
        .stepper-btns button:hover { background: #006233; color: #fff; }

        /* Tooltip */
        .tip { position: relative; display: inline-flex; align-items: center; cursor: help; }
        .tip .tipbox {
            visibility: hidden; opacity: 0;
            width: 220px;
            background: #0f172a;
            border: 1px solid #334155;
            color: #cbd5e1;
            font-size: 11px;
            line-height: 1.5;
            text-align: left;
            border-radius: 8px;
            padding: 8px 10px;
            position: absolute;
            z-index: 10;
            bottom: calc(100% + 6px);
            left: 50%; transform: translateX(-50%);
            transition: opacity 0.2s;
            pointer-events: none;
        }
        .tip:hover .tipbox { visibility: visible; opacity: 1; }

        /* Language toggle */
        .lang-btn {
            color: #cbd5e1;
            transition: all 0.2s ease;
        }
        .lang-btn.active {
            background: #006233;
            color: #fff;
            font-weight: 600;
        }
        .lang-btn:hover:not(.active) {
            color: #e2e8f0;
            background: #475569;
        }

        /* Result pulse animation */
        @keyframes pulse-green {
            0%   { box-shadow: 0 0 0 0 rgba(0,98,51,0.5); }
            70%  { box-shadow: 0 0 0 10px rgba(0,98,51,0); }
            100% { box-shadow: 0 0 0 0 rgba(0,98,51,0); }
        }
        .result-pulse { animation: pulse-green 0.5s ease-out; }

        @media print {
            .no-print { display: none !important; }
            body { background: #fff !important; color: #000 !important; }
        }
    </style>
</head>
<body class="bg-slate-950 text-gray-100 min-h-screen">

<div class="max-w-6xl mx-auto px-3 sm:px-4 py-4 sm:py-8">

    <!-- ‚ïê‚ïê‚ïê HEADER ‚ïê‚ïê‚ïê -->
    <header class="text-center mb-6 sm:mb-8 no-print">
        <div class="flex items-center justify-between mb-4">
            <div class="flex items-center justify-center gap-2 sm:gap-3 flex-1">
                <!-- Car icon -->
                <svg class="w-8 sm:w-10 h-8 sm:h-10 text-alg-green" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8">
                    <path stroke-linecap="round" stroke-linejoin="round"
                        d="M5 13l1.5-4.5A2 2 0 018.4 7h7.2a2 2 0 011.9 1.5L19 13M5 13H3v3a1 1 0 001 1h1m14-4h2v3a1 1 0 01-1 1h-1m-14 0h12m-12 0a2 2 0 100 4 2 2 0 000-4zm12 0a2 2 0 100 4 2 2 0 000-4z"/>
                </svg>
                <h1 class="text-2xl sm:text-3xl md:text-4xl font-bold text-alg-green tracking-tight" id="mainTitle">
                    Car Import Calculator
                </h1>
            </div>
            <!-- Language Toggle -->
            <div class="flex items-center gap-1.5 bg-slate-700/40 rounded-lg p-1.5 backdrop-blur-sm border border-slate-700 flex-wrap">
                <button id="langBtn-en" onclick="setLanguage('en')" class="lang-btn active px-2.5 py-1 text-xs font-medium rounded transition-all duration-200" data-lang="en">EN</button>
                <button id="langBtn-fr" onclick="setLanguage('fr')" class="lang-btn px-2.5 py-1 text-xs font-medium rounded transition-all duration-200" data-lang="fr">FR</button>
                <button id="langBtn-ar" onclick="setLanguage('ar')" class="lang-btn px-2.5 py-1 text-xs font-medium rounded transition-all duration-200" data-lang="ar">AR</button>
                <button id="langBtn-es" onclick="setLanguage('es')" class="lang-btn px-2.5 py-1 text-xs font-medium rounded transition-all duration-200" data-lang="es">ES</button>
            </div>
        </div>
        <p class="text-gray-400 text-xs sm:text-sm px-2" id="subtitle">üá©üáø ÿ≠ÿßÿ≥ÿ®ÿ© ÿßÿ≥ÿ™Ÿäÿ±ÿßÿØ ÿßŸÑÿ≥Ÿäÿßÿ±ÿßÿ™ ŸÑŸÑÿ¨ÿ≤ÿßÿ¶ÿ± &nbsp;|&nbsp; Accurate Landed Cost for Algeria</p>
    </header>

    <div class="grid lg:grid-cols-5 gap-4 sm:gap-6">

        <!-- ‚ïê‚ïê‚ïê LEFT: INPUTS ‚ïê‚ïê‚ïê -->
        <div class="lg:col-span-2 bg-slate-800 rounded-2xl shadow-2xl p-4 sm:p-6 space-y-4 sm:space-y-6">

            <!-- Car Price -->
            <div>
                <h3 class="text-xs font-semibold text-gray-400 uppercase tracking-widest mb-3" data-i18n="carDetails">üöó Car Details</h3>

                <label class="block text-sm font-medium mb-1" data-i18n="carPrice">Car Price (EUR)</label>
                <div class="stepper-wrap">
                    <input type="number" id="itemPrice" value="10000" min="0" step="10">
                    <div class="stepper-btns">
                        <button onclick="step('itemPrice', 1)">‚ñ≤</button>
                        <button onclick="step('itemPrice', -1)">‚ñº</button>
                    </div>
                </div>
            </div>

            <div>
                <label class="block text-sm font-medium mb-1" data-i18n="shippingCost">Shipping Cost (EUR)</label>
                <div class="stepper-wrap">
                    <input type="number" id="shippingCost" value="1500" min="0" step="10">
                    <div class="stepper-btns">
                        <button onclick="step('shippingCost', 1)">‚ñ≤</button>
                        <button onclick="step('shippingCost', -1)">‚ñº</button>
                    </div>
                </div>
            </div>

            <!-- Exchange Rates -->
            <div>
                <h3 class="text-xs font-semibold text-gray-400 uppercase tracking-widest mb-3" data-i18n="exchangeRates">üí± Exchange Rates</h3>

                <label class="block text-sm font-medium mb-1">
                    <span data-i18n="officialRate">Official Rate (DZD/EUR)</span>
                    <span class="tip ml-1">
                        <svg class="w-3.5 h-3.5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                        <span class="tipbox" data-i18n="officialRateTip">Bank of Algeria official rate ‚Äî used to calculate customs tax base only.</span>
                    </span>
                </label>
                <div class="stepper-wrap mb-3">
                    <input type="number" id="officialRate" value="153" min="1" step="10">
                    <div class="stepper-btns">
                        <button onclick="step('officialRate', 1)">‚ñ≤</button>
                        <button onclick="step('officialRate', -1)">‚ñº</button>
                    </div>
                </div>

                <label class="block text-sm font-medium mb-1">
                    <span data-i18n="parallelRate">Parallel Rate / Square (DZD/EUR)</span>
                    <span class="tip ml-1">
                        <svg class="w-3.5 h-3.5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                        <span class="tipbox" data-i18n="parallelRateTip">Real street/market rate (Square) ‚Äî used to calculate the actual cost of buying euros.</span>
                    </span>
                </label>
                <div class="stepper-wrap">
                    <input type="number" id="parallelRate" value="280" min="1" step="10">
                    <div class="stepper-btns">
                        <button onclick="step('parallelRate', 1)">‚ñ≤</button>
                        <button onclick="step('parallelRate', -1)">‚ñº</button>
                    </div>
                </div>
            </div>

            <!-- Fees & Taxes -->
            <div>
                <h3 class="text-xs font-semibold text-gray-400 uppercase tracking-widest mb-3" data-i18n="feesAndTaxes">üèõÔ∏è Fees & Taxes</h3>

                <label class="block text-sm font-medium mb-1">
                    <span data-i18n="customsTax">Customs Tax (%)</span>
                    <span class="tip ml-1">
                        <svg class="w-3.5 h-3.5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                        <span class="tipbox" data-i18n="customsTaxTip">Applied ONLY to the car price using the official rate. Shipping is excluded from the customs base.</span>
                    </span>
                </label>
                <div class="stepper-wrap mb-3">
                    <input type="number" id="customsTax" value="20" min="0" max="100" step="1">
                    <div class="stepper-btns">
                        <button onclick="step('customsTax', 1)">‚ñ≤</button>
                        <button onclick="step('customsTax', -1)">‚ñº</button>
                    </div>
                </div>

                <label class="block text-sm font-medium mb-1">
                    <span data-i18n="portFees">Port & Admin Fees (DZD)</span>
                    <span class="tip ml-1">
                        <svg class="w-3.5 h-3.5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                        <span class="tipbox" data-i18n="portFeesTip">Includes port handling, documentation, storage & admin processing fees at the port of entry.</span>
                    </span>
                </label>
                <div class="stepper-wrap">
                    <input type="number" id="portFees" value="90000" min="0" step="10">
                    <div class="stepper-btns">
                        <button onclick="step('portFees', 1)">‚ñ≤</button>
                        <button onclick="step('portFees', -1)">‚ñº</button>
                    </div>
                </div>
            </div>

            <!-- VAT Toggle -->
            <div class="bg-slate-700/60 rounded-xl border border-alg-green/25 p-3 sm:p-4">
                <label class="flex items-start gap-3 cursor-pointer select-none">
                    <div class="relative mt-0.5">
                        <input type="checkbox" id="vatDeductible" class="sr-only peer">
                        <div class="w-10 h-6 bg-slate-600 rounded-full peer-checked:bg-alg-green transition-colors duration-200"></div>
                        <div class="absolute top-1 left-1 w-4 h-4 bg-white rounded-full shadow transition-transform duration-200 peer-checked:translate-x-4"></div>
                    </div>
                    <div>
                        <p class="font-semibold text-alg-gold text-sm" data-i18n="tvaDeduce">TVA D√©ductible (19%)</p>
                        <p class="text-xs text-gray-400 mt-0.5" data-i18n="tvaTip">ŸÜŸÇŸëÿµ 19% ‚Äî For NIF-registered businesses only. Reduces car price before all calculations.</p>
                    </div>
                </label>
                <div id="vatSavingsRow" class="hidden mt-3 pt-3 border-t border-slate-600 text-xs text-green-400 font-medium"></div>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê RIGHT: RESULTS ‚ïê‚ïê‚ïê -->
        <div class="lg:col-span-3 flex flex-col gap-4 sm:gap-5">

            <!-- Big Total Card -->
            <div id="resultCard" class="bg-gradient-to-br from-alg-green via-emerald-800 to-slate-800 rounded-2xl shadow-2xl p-5 sm:p-7">
                <p class="text-sm text-green-200/70 font-medium mb-3 uppercase tracking-widest" data-i18n="totalLandedCost">Total Landed Cost</p>

                <!-- DZD big number -->
                <div id="totalDZD" class="text-4xl sm:text-5xl font-extrabold text-white tracking-tight mb-1">
                    0 DZD
                </div>

                <!-- Centimes -->
                <div id="totalMillions" class="text-2xl sm:text-3xl font-bold text-alg-gold mt-2">
                    0 centimes
                </div>

                <div class="mt-5 pt-4 border-t border-white/15 flex flex-wrap gap-4 text-sm text-green-100/70">
                    <span><span data-i18n="totalEUR">Total EUR</span>: <span id="totalEUR" class="font-semibold text-white">‚Ç¨0.00</span></span>
                    <span id="rateGap" class="italic"></span>
                </div>
            </div>

            <!-- Breakdown Table -->
            <div class="bg-slate-800 rounded-2xl shadow-xl p-4 sm:p-6 flex-1">
                <h2 class="text-base font-bold text-alg-gold mb-4 flex items-center gap-2" data-i18n="costBreakdown">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/>
                    </svg>
                    Cost Breakdown
                </h2>

                <table class="w-full text-sm">
                    <thead>
                        <tr class="text-left text-gray-500 border-b border-slate-700 text-xs uppercase tracking-wide">
                            <th class="pb-2 font-semibold" data-i18n="component">Component</th>
                            <th class="pb-2 font-semibold text-right" data-i18n="amount">Amount (DZD)</th>
                            <th class="pb-2 font-semibold text-right hidden sm:table-cell" data-i18n="rate">Rate</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-slate-700/60">
                        <tr>
                            <td class="py-3 text-gray-300">
                                <span data-i18n="carCost">üöó Car Cost</span>
                                <span id="vatBadge" class="hidden ml-2 text-xs bg-green-800 text-green-300 px-1.5 py-0.5 rounded" data-i18n="vatBadge">‚àí19% TVA</span>
                            </td>
                            <td class="py-3 text-right font-semibold text-white" id="itemCostDZD">‚Äî</td>
                            <td class="py-3 text-right text-gray-500 text-xs hidden sm:table-cell" id="rateParallelLabel">Parallel</td>
                        </tr>
                        <tr>
                            <td class="py-3 text-gray-300" data-i18n="shippingLabel">üö¢ Shipping Cost</td>
                            <td class="py-3 text-right font-semibold text-white" id="shippingCostDZD">‚Äî</td>
                            <td class="py-3 text-right text-gray-500 text-xs hidden sm:table-cell" id="rateParallelLabel2">Parallel</td>
                        </tr>
                        <tr>
                            <td class="py-3 text-gray-300">
                                <span data-i18n="customsLabel">üèõÔ∏è Customs Tax</span>
                                <span class="text-xs text-gray-500 block" data-i18n="customsDetail">(<span id="customsPct">20</span>% on car price only)</span>
                            </td>
                            <td class="py-3 text-right font-semibold text-white" id="customsTaxDZD">‚Äî</td>
                            <td class="py-3 text-right text-gray-500 text-xs hidden sm:table-cell" id="rateOfficialLabel">Official</td>
                        </tr>
                        <tr>
                            <td class="py-3 text-gray-300" data-i18n="portLabel">‚öì Port & Admin Fees</td>
                            <td class="py-3 text-right font-semibold text-white" id="portFeesDZD">‚Äî</td>
                            <td class="py-3 text-right text-gray-500 text-xs hidden sm:table-cell" data-i18n="fixed">Fixed</td>
                        </tr>
                    </tbody>
                    <tfoot>
                        <tr class="border-t-2 border-alg-green/40 bg-alg-green/10 rounded-b-xl">
                            <td class="py-3 pl-2 font-bold text-alg-gold rounded-bl-xl" data-i18n="total">TOTAL</td>
                            <td class="py-3 text-right font-extrabold text-lg text-alg-gold" id="totalRow">‚Äî</td>
                            <td class="py-3 hidden sm:table-cell rounded-br-xl"></td>
                        </tr>
                    </tfoot>
                </table>
            </div>

            <!-- Info note -->
            <div class="bg-blue-950/50 border border-blue-700/30 rounded-xl px-3 sm:px-4 py-2 sm:py-3 text-xs text-blue-300 leading-relaxed">
                <strong data-i18n="infoBox">‚ÑπÔ∏è How it works:</strong>
                <span data-i18n="infoText">Car purchase & shipping are converted at the parallel rate (what you actually pay). Customs tax is calculated only on the car price using the official rate (government valuation). Shipping is excluded from the customs base.</span>
            </div>
        </div>
    </div>

    <footer class="mt-8 sm:mt-10 text-center text-gray-600 text-xs no-print" data-i18n="footer">
        üá©üáø Made for Algerian car importers &nbsp;|&nbsp; Exchange rates fluctuate ‚Äî always verify before purchasing
    </footer>
</div>

<script>
'use strict';

/* ‚îÄ‚îÄ i18n translations ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
const translations = {
    en: {
        pageTitle: 'üöó Algerian Car Import Calculator',
        mainTitle: 'Car Import Calculator',
        subtitle: 'üá©üáø ÿ≠ÿßÿ≥ÿ®ÿ© ÿßÿ≥ÿ™Ÿäÿ±ÿßÿØ ÿßŸÑÿ≥Ÿäÿßÿ±ÿßÿ™ ŸÑŸÑÿ¨ÿ≤ÿßÿ¶ÿ± &nbsp;|&nbsp; Accurate Landed Cost for Algeria',
        totalLandedCost: 'Total Landed Cost',
        centimes: 'centimes',
        totalEUR: 'Total EUR',
        carDetails: 'üöó Car Details',
        carPrice: 'Car Price (EUR)',
        shippingCost: 'Shipping Cost (EUR)',
        exchangeRates: 'üí± Exchange Rates',
        officialRate: 'Official Rate (DZD/EUR)',
        officialRateTip: 'Bank of Algeria official rate ‚Äî used to calculate customs tax base only.',
        parallelRate: 'Parallel Rate / Square (DZD/EUR)',
        parallelRateTip: 'Real street/market rate (Square) ‚Äî used to calculate the actual cost of buying euros.',
        feesAndTaxes: 'üèõÔ∏è Fees & Taxes',
        customsTax: 'Customs Tax (%)',
        customsTaxTip: 'Applied ONLY to the car price using the official rate. Shipping is excluded from the customs base.',
        portFees: 'Port & Admin Fees (DZD)',
        portFeesTip: 'Includes port handling, documentation, storage & admin processing fees at the port of entry.',
        tvaDeduce: 'TVA D√©ductible (19%)',
        tvaTip: 'ŸÜŸÇŸëÿµ 19% ‚Äî For NIF-registered businesses only. Reduces car price before all calculations.',
        tvaSavings: '‚úì TVA savings:',
        costBreakdown: 'Cost Breakdown',
        component: 'Component',
        amount: 'Amount (DZD)',
        rate: 'Rate',
        carCost: 'üöó Car Cost',
        vatBadge: '‚àí19% TVA',
        shippingLabel: 'üö¢ Shipping Cost',
        customsLabel: 'üèõÔ∏è Customs Tax',
        customsDetail: '(% on car price only)',
        portLabel: '‚öì Port & Admin Fees',
        total: 'TOTAL',
        parallel: 'Parallel',
        official: 'Official',
        fixed: 'Fixed',
        infoBox: '‚ÑπÔ∏è How it works:',
        infoText: 'Car purchase & shipping are converted at the parallel rate (what you actually pay). Customs tax is calculated only on the car price using the official rate (government valuation). Shipping is excluded from the customs base.',
        footer: 'üá©üáø Made for Algerian car importers &nbsp;|&nbsp; Exchange rates fluctuate ‚Äî always verify before purchasing'
    },
    fr: {
        pageTitle: 'üöó Calculatrice d\'Importation de Voitures en Alg√©rie',
        mainTitle: 'Calc. Importation Voiture',
        subtitle: 'üá©üáø ÿ≠ÿßÿ≥ÿ®ÿ© ÿßÿ≥ÿ™Ÿäÿ±ÿßÿØ ÿßŸÑÿ≥Ÿäÿßÿ±ÿßÿ™ ŸÑŸÑÿ¨ÿ≤ÿßÿ¶ÿ± &nbsp;|&nbsp; Co√ªt d\'arriv√©e pr√©cis pour l\'Alg√©rie',
        totalLandedCost: 'Co√ªt Total Rendu',
        centimes: 'centimes',
        totalEUR: 'Total EUR',
        carDetails: 'üöó D√©tails Voiture',
        carPrice: 'Prix Voiture (EUR)',
        shippingCost: 'Frais Livraison (EUR)',
        exchangeRates: 'üí± Taux de Change',
        officialRate: 'Taux Officiel (DZD/EUR)',
        officialRateTip: 'Taux officiel de la Banque d\'Alg√©rie ‚Äî utilis√© pour calculer uniquement la base de la taxe douani√®re.',
        parallelRate: 'Taux Parall√®le / Square (DZD/EUR)',
        parallelRateTip: 'Taux r√©el du march√© (Square) ‚Äî utilis√© pour calculer le co√ªt r√©el d\'achat d\'euros.',
        feesAndTaxes: 'üèõÔ∏è Frais & Taxes',
        customsTax: 'Taxe Douani√®re (%)',
        customsTaxTip: 'Appliqu√©e UNIQUEMENT au prix de la voiture au taux officiel. Livraison exclue de la base douani√®re.',
        portFees: 'Frais Port & Admin (DZD)',
        portFeesTip: 'Inclut manutention au port, documentation, stockage & frais administratifs au port d\'entr√©e.',
        tvaDeduce: 'TVA D√©ductible (19%)',
        tvaTip: 'ŸÜŸÇŸëÿµ 19% ‚Äî R√©serv√© aux entreprises enregistr√©es au NIF. R√©duit le prix de la voiture avant tous les calculs.',
        tvaSavings: '‚úì √âconomie TVA:',
        costBreakdown: 'Ventilation des Co√ªts',
        component: 'Composant',
        amount: 'Montant (DZD)',
        rate: 'Taux',
        carCost: 'üöó Co√ªt Voiture',
        vatBadge: '‚àí19% TVA',
        shippingLabel: 'üö¢ Co√ªt Livraison',
        customsLabel: 'üèõÔ∏è Taxe Douani√®re',
        customsDetail: '(% prix voiture uniquement)',
        portLabel: '‚öì Frais Port & Admin',
        total: 'TOTAL',
        parallel: 'Parall√®le',
        official: 'Officiel',
        fixed: 'Fixe',
        infoBox: '‚ÑπÔ∏è Comment √ßa marche:',
        infoText: 'L\'achat de voiture & livraison sont convertis au taux parall√®le (ce que vous payez r√©ellement). La taxe douani√®re est calcul√©e uniquement sur le prix de la voiture au taux officiel (√©valuation gouvernementale). Livraison exclue de la base douani√®re.',
        footer: 'üá©üáø Fait pour les importateurs de voitures alg√©riens &nbsp;|&nbsp; Les taux de change fluctuent ‚Äî v√©rifiez toujours avant d\'acheter'
    },
    ar: {
        pageTitle: 'üöó ÿ≠ÿßÿ≥ÿ®ÿ© ÿßÿ≥ÿ™Ÿäÿ±ÿßÿØ ÿßŸÑÿ≥Ÿäÿßÿ±ÿßÿ™ ŸÑŸÑÿ¨ÿ≤ÿßÿ¶ÿ±',
        mainTitle: 'ÿ≠ÿßÿ≥ÿ®ÿ© ÿßŸÑÿßÿ≥ÿ™Ÿäÿ±ÿßÿØ',
        subtitle: 'üá©üáø ÿ≠ÿßÿ≥ÿ®ÿ© ÿßÿ≥ÿ™Ÿäÿ±ÿßÿØ ÿßŸÑÿ≥Ÿäÿßÿ±ÿßÿ™ ŸÑŸÑÿ¨ÿ≤ÿßÿ¶ÿ± &nbsp;|&nbsp; ÿ≠ÿ≥ÿßÿ® ÿßŸÑÿ™ŸÉŸÑŸÅÿ© ÿßŸÑÿØŸÇŸäŸÇ ŸÑŸÑÿ¨ÿ≤ÿßÿ¶ÿ±',
        totalLandedCost: 'ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑÿ™ŸÉŸÑŸÅÿ©',
        centimes: 'ÿ≥ŸÜÿ™ŸäŸÖ',
        totalEUR: 'ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä EUR',
        carDetails: 'üöó ÿ™ŸÅÿßÿµŸäŸÑ ÿßŸÑÿ≥Ÿäÿßÿ±ÿ©',
        carPrice: 'ÿ≥ÿπÿ± ÿßŸÑÿ≥Ÿäÿßÿ±ÿ© (ŸäŸàÿ±Ÿà)',
        shippingCost: 'ÿ±ÿ≥ŸàŸÖ ÿßŸÑÿ¥ÿ≠ŸÜ (ŸäŸàÿ±Ÿà)',
        exchangeRates: 'üí± ÿ£ÿ≥ÿπÿßÿ± ÿßŸÑÿµÿ±ŸÅ',
        officialRate: 'ÿßŸÑÿ≥ÿπÿ± ÿßŸÑÿ±ÿ≥ŸÖŸä (ÿØÿ¨/ŸäŸàÿ±Ÿà)',
        officialRateTip: 'ÿ≥ÿπÿ± ÿ®ŸÜŸÉ ÿßŸÑÿ¨ÿ≤ÿßÿ¶ÿ± ÿßŸÑÿ±ÿ≥ŸÖŸä ‚Äî ŸäŸèÿ≥ÿ™ÿÆÿØŸÖ ŸÑÿ≠ÿ≥ÿßÿ® ÿ£ÿ≥ÿßÿ≥ ÿßŸÑÿ∂ÿ±Ÿäÿ®ÿ© ÿßŸÑÿ¨ŸÖÿ±ŸÉŸäÿ© ŸÅŸÇÿ∑.',
        parallelRate: 'ÿßŸÑÿ≥ÿπÿ± ÿßŸÑŸÖŸàÿßÿ≤Ÿä / ÿßŸÑÿ≥ŸàŸÇ ÿßŸÑÿ≥ŸàÿØÿßÿ° (ÿØÿ¨/ŸäŸàÿ±Ÿà)',
        parallelRateTip: 'ÿ≥ÿπÿ± ÿßŸÑÿ≥ŸàŸÇ ÿßŸÑÿ≠ŸÇŸäŸÇŸä ‚Äî ŸäŸèÿ≥ÿ™ÿÆÿØŸÖ ŸÑÿ≠ÿ≥ÿßÿ® ÿßŸÑÿ™ŸÉŸÑŸÅÿ© ÿßŸÑŸÅÿπŸÑŸäÿ© ŸÑÿ¥ÿ±ÿßÿ° ÿßŸÑŸäŸàÿ±Ÿà.',
        feesAndTaxes: 'üèõÔ∏è ÿßŸÑÿ±ÿ≥ŸàŸÖ ŸàÿßŸÑÿ∂ÿ±ÿßÿ¶ÿ®',
        customsTax: 'ÿßŸÑÿ∂ÿ±Ÿäÿ®ÿ© ÿßŸÑÿ¨ŸÖÿ±ŸÉŸäÿ© (%)',
        customsTaxTip: 'ÿ™Ÿèÿ∑ÿ®ŸÇ ŸÅŸÇÿ∑ ÿπŸÑŸâ ÿ≥ÿπÿ± ÿßŸÑÿ≥Ÿäÿßÿ±ÿ© ÿ®ÿßŸÑÿ≥ÿπÿ± ÿßŸÑÿ±ÿ≥ŸÖŸä. Ÿäÿ™ŸÖ ÿßÿ≥ÿ™ÿ®ÿπÿßÿØ ÿßŸÑÿ¥ÿ≠ŸÜ ŸÖŸÜ ÿ£ÿ≥ÿßÿ≥ ÿßŸÑÿ∂ÿ±Ÿäÿ®ÿ© ÿßŸÑÿ¨ŸÖÿ±ŸÉŸäÿ©.',
        portFees: 'ÿ±ÿ≥ŸàŸÖ ÿßŸÑŸÖŸäŸÜÿßÿ° ŸàÿßŸÑÿ•ÿØÿßÿ±ÿ© (ÿØÿ¨)',
        portFeesTip: 'ÿ™ÿ¥ŸÖŸÑ ÿßŸÑŸÖŸÜÿßŸàŸÑÿ© ÿ®ÿßŸÑŸÖŸäŸÜÿßÿ° ŸàÿßŸÑÿ™Ÿàÿ´ŸäŸÇ ŸàÿßŸÑÿ™ÿÆÿ≤ŸäŸÜ ŸàÿßŸÑÿ±ÿ≥ŸàŸÖ ÿßŸÑÿ•ÿØÿßÿ±Ÿäÿ© ÿπŸÜÿØ ŸÖŸäŸÜÿßÿ° ÿßŸÑÿØÿÆŸàŸÑ.',
        tvaDeduce: 'ÿßŸÑÿ∂ÿ±Ÿäÿ®ÿ© ÿπŸÑŸâ ÿßŸÑŸÇŸäŸÖÿ© ÿßŸÑŸÖÿ∂ÿßŸÅÿ© ÿßŸÑŸÇÿßÿ®ŸÑÿ© ŸÑŸÑÿÆÿµŸÖ (19%)',
        tvaTip: 'ÿßÿÆŸÅÿ∂ 19% ‚Äî ŸÑŸÑÿ¥ÿ±ŸÉÿßÿ™ ÿßŸÑŸÖÿ≥ÿ¨ŸÑÿ© ÿ®ÿ±ŸÇŸÖ ÿ™ÿπÿ±ŸäŸÅŸä ŸÅŸÇÿ∑. ŸäŸÇŸÑŸÑ ÿ≥ÿπÿ± ÿßŸÑÿ≥Ÿäÿßÿ±ÿ© ŸÇÿ®ŸÑ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ≠ÿ≥ÿßÿ®ÿßÿ™.',
        tvaSavings: '‚úì ÿ™ŸàŸÅŸäÿ± ÿßŸÑÿ∂ÿ±Ÿäÿ®ÿ©:',
        costBreakdown: 'ÿ™ŸÅÿµŸäŸÑ ÿßŸÑÿ™ŸÉÿßŸÑŸäŸÅ',
        component: 'ÿßŸÑŸÖŸÉŸàŸÜ',
        amount: 'ÿßŸÑŸÖÿ®ŸÑÿ∫ (ÿØÿ¨)',
        rate: 'ÿßŸÑÿ≥ÿπÿ±',
        carCost: 'üöó ÿ™ŸÉŸÑŸÅÿ© ÿßŸÑÿ≥Ÿäÿßÿ±ÿ©',
        vatBadge: '‚àí19% ÿ∂ÿ±Ÿäÿ®ÿ©',
        shippingLabel: 'üö¢ ÿ™ŸÉŸÑŸÅÿ© ÿßŸÑÿ¥ÿ≠ŸÜ',
        customsLabel: 'üèõÔ∏è ÿßŸÑÿ∂ÿ±Ÿäÿ®ÿ© ÿßŸÑÿ¨ŸÖÿ±ŸÉŸäÿ©',
        customsDetail: '(% ÿπŸÑŸâ ÿ≥ÿπÿ± ÿßŸÑÿ≥Ÿäÿßÿ±ÿ© ŸÅŸÇÿ∑)',
        portLabel: '‚öì ÿ±ÿ≥ŸàŸÖ ÿßŸÑŸÖŸäŸÜÿßÿ° ŸàÿßŸÑÿ•ÿØÿßÿ±ÿ©',
        total: 'ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä',
        parallel: 'ŸÖŸàÿßÿ≤Ÿä',
        official: 'ÿ±ÿ≥ŸÖŸä',
        fixed: 'ÿ´ÿßÿ®ÿ™',
        infoBox: '‚ÑπÔ∏è ŸÉŸäŸÅ ŸäÿπŸÖŸÑ:',
        infoText: 'Ÿäÿ™ŸÖ ÿ™ÿ≠ŸàŸäŸÑ ÿ¥ÿ±ÿßÿ° ÿßŸÑÿ≥Ÿäÿßÿ±ÿ© ŸàÿßŸÑÿ¥ÿ≠ŸÜ ÿ®ÿßŸÑÿ≥ÿπÿ± ÿßŸÑŸÖŸàÿßÿ≤Ÿä (ŸÖÿß ÿ™ÿØŸÅÿπŸá ŸÅÿπŸÑŸäŸãÿß). Ÿäÿ™ŸÖ ÿ≠ÿ≥ÿßÿ® ÿßŸÑÿ∂ÿ±Ÿäÿ®ÿ© ÿßŸÑÿ¨ŸÖÿ±ŸÉŸäÿ© ŸÅŸÇÿ∑ ÿπŸÑŸâ ÿ≥ÿπÿ± ÿßŸÑÿ≥Ÿäÿßÿ±ÿ© ÿ®ÿßŸÑÿ≥ÿπÿ± ÿßŸÑÿ±ÿ≥ŸÖŸä. Ÿäÿ™ŸÖ ÿßÿ≥ÿ™ÿ®ÿπÿßÿØ ÿßŸÑÿ¥ÿ≠ŸÜ ŸÖŸÜ ÿ£ÿ≥ÿßÿ≥ ÿßŸÑÿ∂ÿ±Ÿäÿ®ÿ© ÿßŸÑÿ¨ŸÖÿ±ŸÉŸäÿ©.',
        footer: 'üá©üáø ŸÖÿµŸÜŸàÿπ ŸÑŸÖÿ≥ÿ™Ÿàÿ±ÿØŸä ÿßŸÑÿ≥Ÿäÿßÿ±ÿßÿ™ ÿßŸÑÿ¨ÿ≤ÿßÿ¶ÿ±ŸäŸäŸÜ &nbsp;|&nbsp; ÿ£ÿ≥ÿπÿßÿ± ÿßŸÑÿµÿ±ŸÅ ÿ™ÿ™ŸÇŸÑÿ® ‚Äî ÿ™ÿ≠ŸÇŸÇ ÿØÿßÿ¶ŸÖŸãÿß ŸÇÿ®ŸÑ ÿßŸÑÿ¥ÿ±ÿßÿ°'
    },
    es: {
        pageTitle: 'üöó Calculadora de Importaci√≥n de Autom√≥viles de Argelia',
        mainTitle: 'Calc. Importaci√≥n Autos',
        subtitle: 'üá©üáø ÿ≠ÿßÿ≥ÿ®ÿ© ÿßÿ≥ÿ™Ÿäÿ±ÿßÿØ ÿßŸÑÿ≥Ÿäÿßÿ±ÿßÿ™ ŸÑŸÑÿ¨ÿ≤ÿßÿ¶ÿ± &nbsp;|&nbsp; Costo de entrega preciso para Argelia',
        totalLandedCost: 'Costo Total Entregado',
        centimes: 'c√©ntimos',
        totalEUR: 'Total EUR',
        carDetails: 'üöó Detalles del Auto',
        carPrice: 'Precio del Auto (EUR)',
        shippingCost: 'Costo de Env√≠o (EUR)',
        exchangeRates: 'üí± Tasas de Cambio',
        officialRate: 'Tasa Oficial (DZD/EUR)',
        officialRateTip: 'Tasa oficial del Banco de Argelia ‚Äî se utiliza solo para calcular la base del arancel aduanal.',
        parallelRate: 'Tasa Paralela / Mercado Negro (DZD/EUR)',
        parallelRateTip: 'Tasa de mercado real ‚Äî se utiliza para calcular el costo real de compra de euros.',
        feesAndTaxes: 'üèõÔ∏è Aranceles e Impuestos',
        customsTax: 'Impuesto Aduanal (%)',
        customsTaxTip: 'Se aplica SOLO al precio del auto utilizando la tasa oficial. El env√≠o se excluye de la base aduanal.',
        portFees: 'Aranceles Portuarios y Administrativos (DZD)',
        portFeesTip: 'Incluye manipulaci√≥n portuaria, documentaci√≥n, almacenamiento y aranceles administrativos en el puerto de entrada.',
        tvaDeduce: 'IVA Deducible (19%)',
        tvaTip: 'Reducir 19% ‚Äî Solo para empresas registradas con NIF. Reduce el precio del auto antes de todos los c√°lculos.',
        tvaSavings: '‚úì Ahorro de IVA:',
        costBreakdown: 'Desglose de Costos',
        component: 'Componente',
        amount: 'Monto (DZD)',
        rate: 'Tasa',
        carCost: 'üöó Costo del Auto',
        vatBadge: '‚àí19% IVA',
        shippingLabel: 'üö¢ Costo de Env√≠o',
        customsLabel: 'üèõÔ∏è Impuesto Aduanal',
        customsDetail: '(% solo en precio del auto)',
        portLabel: '‚öì Aranceles Portuarios y Admin',
        total: 'TOTAL',
        parallel: 'Paralela',
        official: 'Oficial',
        fixed: 'Fijo',
        infoBox: '‚ÑπÔ∏è C√≥mo funciona:',
        infoText: 'La compra de auto y env√≠o se convierten a la tasa paralela (lo que realmente pagas). El impuesto aduanal se calcula solo sobre el precio del auto utilizando la tasa oficial (valoraci√≥n gubernamental). El env√≠o se excluye de la base aduanal.',
        footer: 'üá©üáø Hecho para importadores de autos argelinos &nbsp;|&nbsp; Las tasas de cambio fluct√∫an ‚Äî verifica siempre antes de comprar'
    }
};

let currentLang = localStorage.getItem('lang') || 'en';

function setLanguage(lang) {
    currentLang = lang;
    localStorage.setItem('lang', lang);
    document.documentElement.lang = lang;
    
    // Handle RTL for Arabic
    if (lang === 'ar') {
        document.documentElement.dir = 'rtl';
    } else {
        document.documentElement.dir = 'ltr';
    }
    
    updatePageTranslations();
    
    // Update active button
    document.querySelectorAll('.lang-btn').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.lang === lang);
    });
}

function t(key) {
    return translations[currentLang]?.[key] || translations['en'][key] || key;
}

function updatePageTranslations() {
    // Page title
    const titleEl = document.getElementById('pageTitle');
    if (titleEl) titleEl.textContent = t('pageTitle');
    document.title = t('pageTitle');
    
    // All elements with data-i18n attribute
    document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.getAttribute('data-i18n');
        el.textContent = t(key);
    });
    
    // All elements with data-i18n-html attribute (for HTML content)
    document.querySelectorAll('[data-i18n-html]').forEach(el => {
        const key = el.getAttribute('data-i18n-html');
        el.innerHTML = t(key);
    });
    
    // Specific manual updates for better control
    document.getElementById('mainTitle').textContent = t('mainTitle');
    document.getElementById('subtitle').innerHTML = t('subtitle');
    
    if (document.getElementById('customsPct')) {
        const customsPct = document.getElementById('customsTax').value;
        document.querySelectorAll('[data-i18n="customsDetail"]').forEach(el => {
            el.textContent = `(${customsPct}% ${t('customsDetail').split('%')[1]}`;
        });
    }
}

/* ‚îÄ‚îÄ helpers ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
const $ = id => document.getElementById(id);

function fmt(n, dec = 0) {
    return Number(n).toLocaleString('fr-DZ', {
        minimumFractionDigits: dec,
        maximumFractionDigits: dec
    });
}

/* Step buttons ‚Äî step by 10 (or 1 for % fields) */
function step(id, dir) {
    const el = $(id);
    const s  = parseFloat(el.step) || 10;
    const v  = parseFloat(el.value) || 0;
    const min = parseFloat(el.min ?? '-Infinity');
    el.value = Math.max(min, v + dir * s);
    calculate();
}

/* Debounce */
let _t;
function deb(fn, ms = 120) { clearTimeout(_t); _t = setTimeout(fn, ms); }

/* ‚îÄ‚îÄ main calculation ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚Äì */
function calculate() {
    const carPrice     = Math.max(0, parseFloat($('itemPrice').value)    || 0);
    const shipping     = Math.max(0, parseFloat($('shippingCost').value) || 0);
    const offRate      = Math.max(1, parseFloat($('officialRate').value)  || 153);
    const parRate      = Math.max(1, parseFloat($('parallelRate').value)  || 280);
    const taxPct       = Math.max(0, parseFloat($('customsTax').value)    || 0);
    const portFees     = Math.max(0, parseFloat($('portFees').value)      || 0);
    const vat          = $('vatDeductible').checked;

    // STEP 1 ‚Äî VAT deduction (if applicable)
    const adjCar       = vat ? carPrice * 0.81 : carPrice;
    const vatSaved     = vat ? carPrice * 0.19 : 0;

    // STEP 2 ‚Äî Purchase costs at PARALLEL rate
    const carDZD       = adjCar   * parRate;
    const shipDZD      = shipping * parRate;

    // STEP 3 ‚Äî Customs base = car price ONLY at OFFICIAL rate
    const customsBase  = adjCar * offRate;

    // STEP 4 ‚Äî Customs tax
    const taxDZD       = customsBase * (taxPct / 100);

    // STEP 5 ‚Äî Grand total
    const total        = carDZD + shipDZD + taxDZD + portFees;

    // ‚îÄ‚îÄ millions centimes (1 centime = 1 000 000 DZD)
    const centimes     = total;

    /* ‚îÄ‚îÄ update UI ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */

    // Big result
    $('totalDZD').textContent      = fmt(total) + ' DZD';
    $('totalMillions').textContent = fmt(centimes, 0) + ' centimes';
    $('totalEUR').textContent      = '‚Ç¨' + fmt(carPrice + shipping, 2);
    $('rateGap').textContent       = `Parallel: ${fmt(parRate)} | Official: ${fmt(offRate)}`;

    // Breakdown
    $('itemCostDZD').textContent   = fmt(carDZD);
    $('shippingCostDZD').textContent = fmt(shipDZD);
    $('customsTaxDZD').textContent = fmt(taxDZD);
    $('portFeesDZD').textContent   = fmt(portFees);
    $('totalRow').textContent      = fmt(total);
    $('customsPct').textContent    = taxPct;

    // Rate labels in table
    $('rateParallelLabel').textContent  = `Parallel (${fmt(parRate)})`;
    $('rateParallelLabel2').textContent = `Parallel (${fmt(parRate)})`;
    $('rateOfficialLabel').textContent  = `Official (${fmt(offRate)})`;

    // VAT badge & savings
    $('vatBadge').classList.toggle('hidden', !vat);
    const savRow = $('vatSavingsRow');
    if (vat) {
        savRow.classList.remove('hidden');
        savRow.textContent =
            `‚úì TVA savings: ‚Ç¨${fmt(vatSaved, 2)} saved (${fmt(vatSaved * parRate)} DZD at parallel rate)`;
    } else {
        savRow.classList.add('hidden');
    }

    // Pulse animation on result card
    const card = $('resultCard');
    card.classList.remove('result-pulse');
    void card.offsetWidth; // reflow
    card.classList.add('result-pulse');
}

/* ‚îÄ‚îÄ event listeners ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
['itemPrice','shippingCost','officialRate','parallelRate','customsTax','portFees']
    .forEach(id => $(id).addEventListener('input', () => deb(calculate)));

$('vatDeductible').addEventListener('change', calculate);

// Initialize language and calculate on load
document.addEventListener('DOMContentLoaded', () => {
    // Set initial language
    const langToLoad = localStorage.getItem('lang') || 'en';
    setLanguage(langToLoad);
    
    // Set RTL for Arabic
    if (langToLoad === 'ar') {
        document.documentElement.dir = 'rtl';
    }
    
    // Highlight active language button
    document.querySelectorAll('.lang-btn').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.lang === langToLoad);
    });
    
    // Run initial calculation
    calculate();
});

</script>
</body>
</html>